<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Campionato Bocce 2ª Categoria</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body { font-family: Arial, sans-serif; text-align: center; margin: 20px; }
#logo { max-width: 200px; margin-top: 20px; }
#powered { position: fixed; bottom: 10px; right: 10px; font-size: 0.8em; color: #555; }
#adminForm { display: none; margin-top: 20px; }
#classifica { margin-top: 30px; }
input { margin: 5px; padding: 5px; }
button { margin: 5px; padding: 5px 10px; }
</style>
</head>
<body>

<img id="logo" src="logo.png" alt="Logo ASD Bocciofila Marghine Borore">

<h1>Campionato Bocce 2ª Categoria</h1>

<button id="loginBtn">Accedi come amministratore</button>

<div id="adminForm">
<h2>Gestione Squadre</h2>
<input type="text" id="teamName" placeholder="Nome squadra">
<input type="number" id="teamPoints" placeholder="Punti iniziali" min="0">
<button id="addTeamBtn">Aggiungi squadra</button>
</div>

<div id="classifica">
<h2>Classifica</h2>
</div>

<div id="powered">Powered by Gianni Casu</div>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.1/firebase-app.js";
import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.6.1/firebase-auth.js";
import { getFirestore, collection, addDoc, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/10.6.1/firebase-firestore.js";

// CONFIG FIREBASE
const firebaseConfig = {
  apiKey: "AIzaSyCgQZG0pqKXl9k_umgPOTFRlGLXiH04su4",
  authDomain: "campionatobocce.firebaseapp.com",
  projectId: "campionatobocce",
  storageBucket: "campionatobocce.appspot.com",
  messagingSenderId: "848729533933",
  appId: "1:848729533933:web:3f66830a54c2accb060be4"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// ELEMENTI
const loginBtn = document.getElementById("loginBtn");
const adminForm = document.getElementById("adminForm");
const addTeamBtn = document.getElementById("addTeamBtn");
const classificaDiv = document.getElementById("classifica");

// LOGIN AMMINISTRATORE
loginBtn.addEventListener("click", () => {
  alert("Hai cliccato il pulsante!");
  adminForm.style.display = "block";
});


// AGGIUNGI SQUADRA
addTeamBtn.addEventListener("click", async () => {
  const nome = document.getElementById("teamName").value.trim();
  const punti = parseInt(document.getElementById("teamPoints").value) || 0;
  if(nome === "") { alert("Inserisci il nome squadra"); return; }
  try {
    await addDoc(collection(db, "squadre"), { nome: nome, punti: punti });
    document.getElementById("teamName").value = "";
    document.getElementById("teamPoints").value = "";
    caricaClassifica();
  } catch (error) {
    alert("Errore aggiunta squadra: " + error.message);
  }
});

// CARICA CLASSIFICA
async function caricaClassifica() {
  try {
    const q = query(collection(db, "squadre"), orderBy("punti", "desc"));
    const snapshot = await getDocs(q);
    classificaDiv.innerHTML = "<h2>Classifica</h2>";
    snapshot.forEach(doc => {
      const data = doc.data();
      classificaDiv.innerHTML += `<p>${data.nome}: ${data.punti} punti</p>`;
    });
  } catch (error) {
    alert("Errore caricamento classifica: " + error.message);
  }
}

// CARICA SUBITO CLASSIFICA
caricaClassifica();
</script>

</body>
</html>